<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Morph Targets</title><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Id" content="b44b915a-f5f6-416a-9ffb-98de885812d7" /><meta name="Description" content="Meshes support morph target animation (a.k.a. per-vertex animation, blend shape interpolation, or just morphing). Morph targets (a.k.a. blend shapes) can be used for a variety of things:" /><meta name="Microsoft.Help.ContentType" content="Concepts" /><meta name="BrandingAware" content="true" /><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"> </script><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-1.11.0.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">DigitalRune Documentation<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="38bd0f53-477c-48c5-91cc-b9fb7062ceb3.htm" title="DigitalRune Documentation" tocid="roottoc">DigitalRune Documentation</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="0a8eb9ca-74ae-4746-9289-93d909b07e22.htm" title="DigitalRune Graphics" tocid="0a8eb9ca-74ae-4746-9289-93d909b07e22">DigitalRune Graphics</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="7d5a0abe-8231-452c-895c-e6dbab83822b.htm" title="Graphics Programming" tocid="7d5a0abe-8231-452c-895c-e6dbab83822b">Graphics Programming</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="cb08d0d8-8ea6-49fc-b318-b185dbb70608.htm" title="Models and Meshes" tocid="cb08d0d8-8ea6-49fc-b318-b185dbb70608">Models and Meshes</a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="b44b915a-f5f6-416a-9ffb-98de885812d7.htm" title="Morph Targets" tocid="b44b915a-f5f6-416a-9ffb-98de885812d7">Morph Targets</a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="logoColumn"><img alt="DigitalRune" src="../icons/DigitalRune-Logo.png" /></td><td class="titleColumn">Morph Targets</td></tr></table><span class="introStyle"></span><div class="introduction"><p>This topic contains the following sections:</p><ul class="autoOutline"><li class="outlineSectionEntry"><a href="#Overview">Overview</a></li><li class="outlineSectionEntry"><a href="#Video">Video</a></li><li class="outlineSectionEntry"><a href="#Import">Importing morph targets</a></li><li class="outlineSectionEntry"><a href="#Materials">Materials</a></li><li class="outlineSectionEntry"><a href="#Animation">Animating morph targets</a></li><li class="outlineSectionEntry"><a href="#Rendering">Rendering morph targets</a></li></ul></div><div class="collapsibleAreaRegion" id="Overview"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Overview</span></div><div id="ID1RBSection" class="collapsibleSection"><p>
                    Meshes support
                    <em>morph target animation</em> (a.k.a.
                    <em>per-vertex animation</em>,
                    <em>blend shape interpolation</em>, or just
                    <em>morphing</em>).
                    Morph targets (a.k.a. blend shapes) can be used for
                    a variety of things:
                </p><ul><li>
                        to morph one object into another,
                    </li><li>
                        to animate the bulging of muscles,
                    </li><li>
                        as corrective shapes to fix bone deformations,
                    </li><li>
                        as damage states for models,
                    </li><li>
                        etc.
                    </li></ul><p>
                    But the most prominent application is facial animation. In the past, there have been games
                    that relied solely on skeletal animation for facial animation, but modern games typically
                    use a combination of skeletal animation and morph targets.
                </p><p>
                    Morph targets are stored per submesh in the <a href="a9ba90a7-30a5-861e-f9a4-17cbd4bf1e64.htm">MorphTargets</a>
                    collection. Morph targets are identified by their name (e.g. "smile", "frown", "blink", etc.).
                    The morph target stores the vertices relative to the submesh, i.e. only the difference
                    between the morph target and the base mesh is stored (a.k.a.
                    <em>delta shapes</em>").
                </p><p>
                    The <a href="af7c9ac6-a7a0-e5e2-0743-59e60f5e4d62.htm">MorphWeights</a>
                    stored by the <a href="150b5feb-ef12-d0be-cd27-0a32759af0ba.htm">MeshNode</a>
                    control the morph targets. Morph target weights can be set directly or animated using
                    <a href="c2892dfd-491e-4e78-83d1-737e38f1acc9.htm">DigitalRune Animation</a>.
                </p><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0EAAAGAAA_tab1" class="codeSnippetContainerTabSingle">Activate a morph target</div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EAAAGAAA_copyCode" href="#" onclick="javascript:CopyToClipboard('ID0EAAAGAAA');return false;" title="Copy">Copy</a></div></div><div id="ID0EAAAGAAA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="highlight-comment">// Show the morph target named "smile".</span>
meshNode.MorphWeights[<span class="highlight-literal">"smile"</span>] = <span class="highlight-number">1.0</span>f;</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EAAAGAAA");</script></div><div class="collapsibleAreaRegion" id="Video"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Video</span></div><div id="ID2RBSection" class="collapsibleSection"><p>
                    The following video demonstrates the use of morph targets for facial animation:
                </p><ul class="noBullet"><li><p><a href="https://www.youtube.com/watch?v=fM7RyLp0m2A" target="_blank">Video: Facial Animation using Morph Targets</a></p></li></ul></div><div class="collapsibleAreaRegion" id="Import"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID3RB')" onkeypress="SectionExpandCollapse_CheckKey('ID3RB', event)" tabindex="0"><img id="ID3RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Importing morph targets</span></div><div id="ID3RBSection" class="collapsibleSection"><p>
                    The topic
                    <a href="c961412f-43c7-4b82-a68d-b20dd2d5131f.htm">Asset Creation: Morph Targets</a>
                    explains how to load morph targets
                    using the XNA content pipeline.
                </p></div><div class="collapsibleAreaRegion" id="Materials"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID4RB')" onkeypress="SectionExpandCollapse_CheckKey('ID4RB', event)" tabindex="0"><img id="ID4RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Materials</span></div><div id="ID4RBSection" class="collapsibleSection"><p>
                    Mesh deformations are calculated on the GPU. Therefore the model requires a special effects.
                    See <a href="fda15306-d5dc-449c-850d-82227359d35b.htm">Predefined Effects</a>.
                    Here is an example material:
                </p><div class="codeSnippetContainer"><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EAAADAAA_copyCode" href="#" onclick="javascript:CopyToClipboard('ID0EAAADAAA');return false;" title="Copy">Copy</a></div></div><div id="ID0EAAADAAA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="highlight-xml-bracket">&lt;?</span><span class="highlight-xml-tag">xml</span> <span class="highlight-xml-attribute-name">version</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">"1.0"</span> <span class="highlight-xml-attribute-name">encoding</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">"utf-8"</span><span class="highlight-xml-bracket">?&gt;</span>
<span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">Material</span><span class="highlight-xml-bracket">&gt;</span>
  <span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">Pass</span> <span class="highlight-xml-attribute-name">Name</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">"ShadowMap"</span> <span class="highlight-xml-attribute-name">Effect</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">"DigitalRune/Materials/ShadowMapMorphSkinned"</span> <span class="highlight-xml-attribute-name">Profile</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">"HiDef"</span> <span class="highlight-xml-bracket">/&gt;</span>
  <span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">Pass</span> <span class="highlight-xml-attribute-name">Name</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">"GBuffer"</span> <span class="highlight-xml-attribute-name">Effect</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">"DigitalRune/Materials/GBufferMorphSkinned"</span> <span class="highlight-xml-attribute-name">Profile</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">"HiDef"</span><span class="highlight-xml-bracket">&gt;</span>
    <span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">Parameter</span> <span class="highlight-xml-attribute-name">Name</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">"SpecularPower"</span> <span class="highlight-xml-attribute-name">Value</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">"75"</span> <span class="highlight-xml-bracket">/&gt;</span>
  <span class="highlight-xml-bracket">&lt;/</span><span class="highlight-xml-tag">Pass</span><span class="highlight-xml-bracket">&gt;</span>
  <span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">Pass</span> <span class="highlight-xml-attribute-name">Name</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">"Material"</span> <span class="highlight-xml-attribute-name">Effect</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">"DigitalRune/Materials/MaterialMorphSkinned"</span> <span class="highlight-xml-attribute-name">Profile</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">"HiDef"</span><span class="highlight-xml-bracket">&gt;</span>
    <span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">Parameter</span> <span class="highlight-xml-attribute-name">Name</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">"DiffuseColor"</span> <span class="highlight-xml-attribute-name">Value</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">"1,0.9,0.8,1"</span> <span class="highlight-xml-bracket">/&gt;</span>
    <span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">Parameter</span> <span class="highlight-xml-attribute-name">Name</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">"SpecularColor"</span> <span class="highlight-xml-attribute-name">Value</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">"1,0.81,0.64,1"</span> <span class="highlight-xml-bracket">/&gt;</span>
    <span class="highlight-xml-bracket">&lt;</span><span class="highlight-xml-tag">Texture</span> <span class="highlight-xml-attribute-name">Name</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">"DiffuseTexture"</span> <span class="highlight-xml-attribute-name">File</span><span class="highlight-xml-attribute-equal">=</span><span class="highlight-xml-attribute-value">"sintel_face_diff.png"</span> <span class="highlight-xml-bracket">/&gt;</span>
  <span class="highlight-xml-bracket">&lt;/</span><span class="highlight-xml-tag">Pass</span><span class="highlight-xml-bracket">&gt;</span>
<span class="highlight-xml-bracket">&lt;/</span><span class="highlight-xml-tag">Material</span><span class="highlight-xml-bracket">&gt;</span></pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EAAADAAA");</script></div><div class="collapsibleAreaRegion" id="Animation"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID5RB')" onkeypress="SectionExpandCollapse_CheckKey('ID5RB', event)" tabindex="0"><img id="ID5RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Animating morph targets</span></div><div id="ID5RBSection" class="collapsibleSection"><p>
                    The property
                    <a href="af7c9ac6-a7a0-e5e2-0743-59e60f5e4d62.htm">MorphWeights</a>
                    implements the interface
                    <a href="58812efb-838c-b735-4cc7-97ff368daa12.htm">IAnimatableObject</a>,
                    which means it can be animated using DigitalRune Animation. For example:
                </p><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID0EABACAAA_tab1" class="codeSnippetContainerTabSingle">C#</div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID0EABACAAA_copyCode" href="#" onclick="javascript:CopyToClipboard('ID0EABACAAA');return false;" title="Copy">Copy</a></div></div><div id="ID0EABACAAA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="highlight-keyword">var</span> smile = <span class="highlight-keyword">new</span> SingleKeyFrameAnimation { TargetProperty = <span class="highlight-literal">"MOUTH-smile"</span> };
smile.KeyFrames.Add(<span class="highlight-keyword">new</span> KeyFrame&lt;<span class="highlight-keyword">float</span>&gt;(TimeSpan.FromSeconds(<span class="highlight-number">0</span>), <span class="highlight-number">0</span>));
smile.KeyFrames.Add(<span class="highlight-keyword">new</span> KeyFrame&lt;<span class="highlight-keyword">float</span>&gt;(TimeSpan.FromSeconds(<span class="highlight-number">1</span>), <span class="highlight-number">1</span>));
smile.KeyFrames.Add(<span class="highlight-keyword">new</span> KeyFrame&lt;<span class="highlight-keyword">float</span>&gt;(TimeSpan.FromSeconds(<span class="highlight-number">4</span>), <span class="highlight-number">1</span>));
smile.KeyFrames.Add(<span class="highlight-keyword">new</span> KeyFrame&lt;<span class="highlight-keyword">float</span>&gt;(TimeSpan.FromSeconds(<span class="highlight-number">5</span>), <span class="highlight-number">0</span>));

<span class="highlight-keyword">var</span> blink = <span class="highlight-keyword">new</span> SingleKeyFrameAnimation { TargetProperty = <span class="highlight-literal">"EYES-closed"</span> };
blink.KeyFrames.Add(<span class="highlight-keyword">new</span> KeyFrame&lt;<span class="highlight-keyword">float</span>&gt;(TimeSpan.FromSeconds(<span class="highlight-number">3.75</span>), <span class="highlight-number">0</span>));
blink.KeyFrames.Add(<span class="highlight-keyword">new</span> KeyFrame&lt;<span class="highlight-keyword">float</span>&gt;(TimeSpan.FromSeconds(<span class="highlight-number">4</span>), <span class="highlight-number">1</span>));
blink.KeyFrames.Add(<span class="highlight-keyword">new</span> KeyFrame&lt;<span class="highlight-keyword">float</span>&gt;(TimeSpan.FromSeconds(<span class="highlight-number">4.25</span>), <span class="highlight-number">0</span>));

<span class="highlight-keyword">var</span> timelineGroup = <span class="highlight-keyword">new</span> TimelineGroup();
timelineGroup.Add(smile);
timelineGroup.Add(blink);

<span class="highlight-keyword">var</span> controller = AnimationService.StartAnimation(timelineGroup, meshNode.MorphWeights);</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID0EABACAAA");</script><p>
                    All features of DigitalRune Animation (composition, blending, transitions, …) can be
                    directly applied to morph targets.
                </p></div><div class="collapsibleAreaRegion" id="Rendering"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID6RB')" onkeypress="SectionExpandCollapse_CheckKey('ID6RB', event)" tabindex="0"><img id="ID6RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Rendering morph targets</span></div><div id="ID6RBSection" class="collapsibleSection"><p>
                    Meshes with morph targets are rendered by the
                    <a href="1782e7fc-9a12-dd2d-d73d-8396a786fdeb.htm">MeshRenderer</a>
                    as usual. The
                    <a href="fda15306-d5dc-449c-850d-82227359d35b.htm">predefined material shaders</a>
                    support up to 5 active morph targets simultaneously. When more morph targets are activated
                    only the 5 morph targets with the largest morph weights are rendered.
                </p></div></div></div><div id="pageFooter" class="pageFooter">Copyright (c) 2006-2016 DigitalRune GmbH. All rights reserved. (Last updated: 2016-03-10)<p><a href="http://www.digitalrune.com/" target="_blank">http://www.digitalrune.com/</a></p><div class="feedbackLink">Send comments on this topic to
        <a id="HT_MailLink" href="mailto:office%40digitalrune.com?Subject=DigitalRune Documentation">office@digitalrune.com</a></div><script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        var HT_mailLinkText = HT_mailLink.innerHTML;
        HT_mailLink.href += ": " + document.title + "\u0026body=" + encodeURIComponent("Your feedback is used to improve the documentation and the product. Your e-mail address will not be used for any other purpose and is disposed of after the issue you report is resolved. While working to resolve the issue that you report, you may be contacted via e-mail to get further details or clarification on the feedback you sent. After the issue you report has been addressed, you may receive an e-mail to let you know that your feedback has been addressed.");
        HT_mailLink.innerHTML = HT_mailLinkText;
        </script></div></body></html>