<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Water</title><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Id" content="5697f90f-2893-4ed5-ae66-da63afccdfc3" /><meta name="Description" content="This topic describes how to define bodies of water, e.g. rivers, ponds, lakes, ocean." /><meta name="Microsoft.Help.ContentType" content="Concepts" /><meta name="BrandingAware" content="true" /><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"> </script><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-1.11.0.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">DigitalRune Documentation<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="38bd0f53-477c-48c5-91cc-b9fb7062ceb3.htm" title="DigitalRune Documentation" tocid="roottoc">DigitalRune Documentation</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="0a8eb9ca-74ae-4746-9289-93d909b07e22.htm" title="DigitalRune Graphics" tocid="0a8eb9ca-74ae-4746-9289-93d909b07e22">DigitalRune Graphics</a></div><div class="toclevel1" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="7d5a0abe-8231-452c-895c-e6dbab83822b.htm" title="Graphics Programming" tocid="7d5a0abe-8231-452c-895c-e6dbab83822b">Graphics Programming</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="fda6c965-0105-4a5e-a0db-f8fa6ec4e73f.htm" title="Graphics Service" tocid="fda6c965-0105-4a5e-a0db-f8fa6ec4e73f">Graphics Service</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="2e870374-8980-4fbc-9426-1d1a6e2d9766.htm" title="Graphics Screens" tocid="2e870374-8980-4fbc-9426-1d1a6e2d9766">Graphics Screens</a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="4d8c922f-60cb-4b92-a22c-03c9e8816712.htm" title="Scene Management" tocid="4d8c922f-60cb-4b92-a22c-03c9e8816712">Scene Management</a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="6b3a13bc-37b4-4820-9f82-c2364a9ed2eb.htm" title="Rendering" tocid="6b3a13bc-37b4-4820-9f82-c2364a9ed2eb">Rendering</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="ba1be841-af9c-41a4-8348-0b6bd92efdd9.htm" title="Effects and Effect Bindings" tocid="ba1be841-af9c-41a4-8348-0b6bd92efdd9">Effects and Effect Bindings</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="34a7f065-df4f-4f40-8b5c-5f0afee365db.htm" title="Materials and Material Instances" tocid="34a7f065-df4f-4f40-8b5c-5f0afee365db">Materials and Material Instances</a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="cb08d0d8-8ea6-49fc-b318-b185dbb70608.htm" title="Models and Meshes" tocid="cb08d0d8-8ea6-49fc-b318-b185dbb70608">Models and Meshes</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="fda1f969-9b64-4851-873c-a59466ac69ba.htm" title="Cameras" tocid="fda1f969-9b64-4851-873c-a59466ac69ba">Cameras</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="e316a87e-0cdb-4c6b-bcb0-a2e66004c26f.htm" title="Lights" tocid="e316a87e-0cdb-4c6b-bcb0-a2e66004c26f">Lights</a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="3f82c46b-efec-4416-807f-670ac1930117.htm" title="Shadows" tocid="3f82c46b-efec-4416-807f-670ac1930117">Shadows</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="630fb69e-a032-4125-bdc0-5484fbe2c86d.htm" title="Lens Flares" tocid="630fb69e-a032-4125-bdc0-5484fbe2c86d">Lens Flares</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="f782dc86-40e9-45c1-869a-4baf86e28ed9.htm" title="Decals" tocid="f782dc86-40e9-45c1-869a-4baf86e28ed9">Decals</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="4518dd2c-21ea-4cf8-8dec-8b3a32584743.htm" title="Billboards and Particles" tocid="4518dd2c-21ea-4cf8-8dec-8b3a32584743">Billboards and Particles</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="d4d56ebf-a623-492c-bd37-b41a2979323e.htm" title="Sprites (Images and Text)" tocid="d4d56ebf-a623-492c-bd37-b41a2979323e">Sprites (Images and Text)</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="d70873e7-1dbc-492b-b10d-1afb6f06687a.htm" title="Figures (Lines, 2D Shapes)" tocid="d70873e7-1dbc-492b-b10d-1afb6f06687a">Figures (Lines, 2D Shapes)</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="0bc6a222-64d5-4642-a2b6-241e9017c873.htm" title="Fog" tocid="0bc6a222-64d5-4642-a2b6-241e9017c873">Fog</a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="975dcbca-5c87-4f33-a372-0cfe7f50cebe.htm" title="Sky" tocid="975dcbca-5c87-4f33-a372-0cfe7f50cebe">Sky</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="46f261f5-750c-4df5-99e2-b6a289f15098.htm" title="Terrain" tocid="46f261f5-750c-4df5-99e2-b6a289f15098">Terrain</a></div><div class="toclevel2 current" data-toclevel="2"><a data-tochassubtree="false" href="5697f90f-2893-4ed5-ae66-da63afccdfc3.htm" title="Water" tocid="5697f90f-2893-4ed5-ae66-da63afccdfc3">Water</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="924e5123-9ed9-4db7-bd0c-2ec8589985ed.htm" title="Post-Processing" tocid="924e5123-9ed9-4db7-bd0c-2ec8589985ed">Post-Processing</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="b7e96cd7-c737-4805-b5a9-98f1e8acd1d5.htm" title="Anti-Aliasing" tocid="b7e96cd7-c737-4805-b5a9-98f1e8acd1d5">Anti-Aliasing</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="b320aebd-46a0-45d8-8edb-0c717152a56b.htm" title="Level of Detail (LOD)" tocid="b320aebd-46a0-45d8-8edb-0c717152a56b">Level of Detail (LOD)</a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="cc20d61e-83cb-46c7-a2e2-0841a35043ba.htm" title="Occlusion Culling" tocid="cc20d61e-83cb-46c7-a2e2-0841a35043ba">Occlusion Culling</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="7fbfaba5-af8d-4bf7-b5c3-6c084e1bfc54.htm" title="Windows Forms, WPF, UWP Interoperability" tocid="7fbfaba5-af8d-4bf7-b5c3-6c084e1bfc54">Windows Forms, WPF, UWP Interoperability</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="4e6f5dc1-8897-466f-88f2-b5c56d43a3c5.htm" title="Miscellaneous" tocid="4e6f5dc1-8897-466f-88f2-b5c56d43a3c5">Miscellaneous</a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="logoColumn"><img alt="DigitalRune" src="../icons/DigitalRune-Logo.png" /></td><td class="titleColumn">Water</td></tr></table><span class="introStyle"></span><div class="introduction"><p>
                This topic describes how to define bodies of water, e.g. rivers, ponds,
                lakes, ocean.
            </p><p>This topic contains the following sections:</p><ul class="autoOutline"><li class="outlineSectionEntry"><a href="#Video">Video</a></li><li class="outlineSectionEntry"><a href="#Water">Defining water</a></li><ul class="autoOutline"><li class="outlineSectionEntry"><a href="#WaterNode">WaterNode</a></li><li class="outlineSectionEntry"><a href="#Water">Water</a></li><li class="outlineSectionEntry"><a href="#WaterFlow">WaterFlow</a></li><li class="outlineSectionEntry"><a href="#WaterWaves">WaterWaves</a></li></ul><li class="outlineSectionEntry"><a href="#Rendering">Rendering water</a></li><ul class="autoOutline"><li class="outlineSectionEntry"><a href="#WaterRenderer">WaterRenderer</a></li><li class="outlineSectionEntry"><a href="#Refraction">Refractions</a></li><li class="outlineSectionEntry"><a href="#AlphaBlending">Water and alpha-blended/transparent objects</a></li><li class="outlineSectionEntry"><a href="#WaterWavesRenderer">WaterWavesRenderer</a></li></ul><li class="outlineSectionEntry"><a href="#FurtherReading">Further Reading</a></li></ul></div><div class="collapsibleAreaRegion" id="Video"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID0RB')" onkeypress="SectionExpandCollapse_CheckKey('ID0RB', event)" tabindex="0"><img id="ID0RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Video</span></div><div id="ID0RBSection" class="collapsibleSection"><p>
                    The following video shows various features of the water rendering in DigitalRune
                    Graphics.
                </p><ul class="noBullet"><li><p><a href="https://www.youtube.com/watch?v=lUdBm81y1Ik" target="_blank">Video: Water Rendering</a></p></li></ul></div><div class="collapsibleAreaRegion" id="Water"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Defining water</span></div><div id="ID1RBSection" class="collapsibleSection"><p>
                    DigitalRune Graphics uses following types to define bodies of water:
                </p><div class="mediaNear"><img alt="DigitalRune.Graphics (Water)" src="../media/Graphics_Water.png" /><div class="caption">Class Diagram: Water</div></div><h4 class="subHeading" id="WaterNode">WaterNode</h4><div class="subsection"><p>
                            A
                            <a href="a37d4fda-9e99-bfc3-8c39-f6d020547d4b.htm">WaterNode</a>
                            is a
                            <a href="206bf836-6510-1c9d-02d4-c0c9a30a75a0.htm">SceneNode</a>
                            that defines a body of water.
                            <a href="a37d4fda-9e99-bfc3-8c39-f6d020547d4b.htm">WaterNode</a>s
                            are rendered by the
                            <a href="a88a6a4e-ce04-777a-96d0-465293ed24f3.htm">WaterRenderer</a>.
                        </p><p>
                            The property
                            <a href="54515785-0aa8-dcab-adfb-603b3d5aae6e.htm">Volume</a>
                            is a <a href="efff4741-4f03-f106-4b42-5892eb21377e.htm">Shape</a>
                            which defines the water surface and the underwater volume where an underwater effect is
                            rendered.
                            If <a href="54515785-0aa8-dcab-adfb-603b3d5aae6e.htm">Volume</a>
                            is set to a valid shape, the shape defines where the water will be rendered.
                            The shape can be a "flat" shape, e.g. a horizontal rectangle. It only has to be a non-flat
                            shape, e.g. a box, when the camera can enter the water volume and an underwater effect
                            should be rendered.
                            If <a href="54515785-0aa8-dcab-adfb-603b3d5aae6e.htm">Volume</a>
                            is <span class="code">null</span>, a horizontal infinite ocean plane is rendered and everything
                            under the plane counts as underwater.
                            The
                            <a href="54515785-0aa8-dcab-adfb-603b3d5aae6e.htm">Volume</a>
                            should be positioned in the local scene node space, such that the water surface goes through
                            the origin of the scene node (y = 0). And the water surface should be roughly horizontal.
                            The
                            <a href="a88a6a4e-ce04-777a-96d0-465293ed24f3.htm">WaterRenderer</a>
                            is optimized for this configuration.
                        </p><p>
                            The water surface can reflect a static skybox
                            (property <a href="3665dbb4-14ef-5751-23f0-c96667648bff.htm">SkyboxReflection</a>)
                            or a planar reflection (property <a href="be741eca-71fd-f57d-4576-b6e1101e5a2d.htm">PlanarReflection</a>).
                            If the water surface is displaced by high waves, then planar reflections might lead to
                            some visual artifacts. For small waves a planar reflection is usually an adequate
                            approximation of the real reflection.
                            Planar reflections are expensive in most scenes and in most games a static skybox should
                            be used.
                        </p><p>
                            The
                            <a href="54515785-0aa8-dcab-adfb-603b3d5aae6e.htm">Volume</a>
                            is also used as the bounding shape for frustum culling. If the water is displaced by waves,
                            then
                            <a href="54515785-0aa8-dcab-adfb-603b3d5aae6e.htm">Volume</a>
                            is not a valid shape because some water vertices can be moved outside this bounding shape.
                            For this case, an
                            <a href="0e5eb60a-b49f-c586-eed8-5b8e4420a62f.htm">ExtraHeight</a>
                            has to be set which is at least as large as the highest wave. Internally,
                            <a href="0e5eb60a-b49f-c586-eed8-5b8e4420a62f.htm">ExtraHeight</a>
                            is used to increase the bounding shape to get a shape which will contain all waves.
                        </p><div class="alert"><table><tr><th><img src="../icons/AlertNote.png" alt="Tip" /> Tip</th></tr><tr><td><p>
                                An infinite ocean can be rendered by setting
                                <a href="54515785-0aa8-dcab-adfb-603b3d5aae6e.htm">Volume</a>
                                to <span class="code">null</span>. When the ocean is not visible, e.g. because the player
                                is inside a house or a cave, it is recommended to disable the ocean, e.g.
                                by setting
                                <a href="9c6350a1-2d01-de65-43fe-b990190b282f.htm">SceneNode<span id="LSTC84BB5A9_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTC84BB5A9_0?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>IsEnabled</a>
                                to
                                <span class="code">false</span>.
                            </p><p>
                                If the camera cannot enter the water, it is also recommended to set
                                <a href="cb50d0ff-e53b-6880-919c-66c8e32019db.htm">EnableUnderwaterEffect</a>
                                to
                                <span class="code">false</span>.
                            </p></td></tr></table></div></div><h4 class="subHeading" id="Water">Water</h4><div class="subsection"><p>
                            The class
                            <a href="e7f826f4-8a3e-539c-ce86-6b532331b2d9.htm">Water</a>
                            defines the visual appearance of the water.
                        </p><p>
                            The water is rendered using reflections, refractions and a specular highlight from the
                            dominant directional light.
                            Water ripples are created using two normal maps which are moved over the water surface.
                            Foam can be rendered where the water intersects geometry and for high water waves.
                            The water also supports real-time underwater caustics (at the moment only for
                            <a href="dbb249d5-f8b7-715b-faea-ddee5c3194a1.htm">WaterWaves</a>
                            and not for water ripples from the normal maps).
                        </p><p>
                            The water color is defined by
                            <a href="85d3b064-edcb-cda1-40a1-7c60ed941955.htm">WaterColor</a>
                            and
                            <a href="18cec781-4a64-2f13-3024-e54234da2a6a.htm">UnderwaterFogDensity</a>.
                            By tweaking this properties, you can create uniform blue water, brown, muddy water
                            or a Caribbean water which is turquoise near the shore and dark blue in the distance.
                        </p></div><h4 class="subHeading" id="WaterFlow">WaterFlow</h4><div class="subsection"><p>
                            The class
                            <a href="4037bf1b-f929-3319-b63b-093051e40ac6.htm">WaterFlow</a>
                            can be used to define the direction in which the water is flowing.
                        </p><div class="alert"><table><tr><th><img src="../icons/AlertNote.png" alt="Note" /> Note</th></tr><tr><td><p>
                                Currently,
                                <a href="4037bf1b-f929-3319-b63b-093051e40ac6.htm">WaterFlow</a>
                                is not rendered if the water is displaced by
                                <a href="dbb249d5-f8b7-715b-faea-ddee5c3194a1.htm">WaterWaves</a>.
                            </p></td></tr></table></div><p>
                            The water flow can be defined using:
                        </p><ul><li>
                                A constant flow direction. See
                                <a href="d075e59c-6a21-41ff-780c-e87b869a26c7.htm">BaseVelocity</a>.
                            </li><li>
                                The vertex normals of the water
                                <a href="54515785-0aa8-dcab-adfb-603b3d5aae6e.htm">Volume</a>.
                                See
                                <a href="7afcdb4c-14b3-b864-fef1-2a72fd5bcf24.htm">SurfaceSlopeSpeed</a>.
                            </li><li>
                                A flow texture. See
                                <a href="479a6471-888c-f480-9e98-ba2384d5c954.htm">FlowMap</a>.
                            </li></ul><p>
                            See
                            <a href="4037bf1b-f929-3319-b63b-093051e40ac6.htm">WaterFlow</a>
                            for more details.
                        </p></div><h4 class="subHeading" id="WaterWaves">WaterWaves</h4><div class="subsection"><p><a href="dbb249d5-f8b7-715b-faea-ddee5c3194a1.htm">WaterWaves</a>
                            can be used to displace the water surface (using vertex shader displacement mapping).
                        </p><p>
                            Using
                            <a href="32392162-517c-10cc-9cdb-f2d287e5f5aa.htm">UserDefinedWaves</a>
                            the wave displacement and normal maps can be defined by the user.
                            The displacement and normal maps must be updated by the user each frame.
                            For example, you could run a custom CPU or GPU ripple simulation in small radius around
                            the player position.
                        </p><p><a href="d75a9c99-aff1-74b5-443d-2eac30055c81.htm">OceanWaves</a>
                            use Fast Fourier Transform (FFT) on the GPU with a stastical model of ocean waves to
                            compute complex, periodic waves. You can also query the displacement of a point on the
                            water surface on the CPU. (This requires that a smaller scale FFT is executed on the CPU
                            and should only be enable when needed. See
                            <a href="0b6be64c-a0cd-51c4-522e-2d2e8cb3dc03.htm">EnableCpuQueries</a>.)
                        </p></div></div><div class="collapsibleAreaRegion" id="Rendering"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID3RB')" onkeypress="SectionExpandCollapse_CheckKey('ID3RB', event)" tabindex="0"><img id="ID3RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Rendering water</span></div><div id="ID3RBSection" class="collapsibleSection"><p>
                    This section explains how to render
                    <a href="a37d4fda-9e99-bfc3-8c39-f6d020547d4b.htm">WaterNode</a>s.
                </p><h4 class="subHeading" id="WaterRenderer">WaterRenderer</h4><div class="subsection"><p><a href="a88a6a4e-ce04-777a-96d0-465293ed24f3.htm">WaterRenderer</a>
                            is a <a href="c022a3a4-2330-9b46-24ad-c8f3ae13f1f8.htm">SceneNodeRenderer</a>
                            which handles
                            <a href="a37d4fda-9e99-bfc3-8c39-f6d020547d4b.htm">WaterNode</a>s.
                        </p><p>
                            The water is usually rendered after all opaque objects:
                        </p><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID2EAAADACAAA_tab1" class="codeSnippetContainerTabSingle">C#</div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID2EAAADACAAA_copyCode" href="#" onclick="javascript:CopyToClipboard('ID2EAAADACAAA');return false;" title="Copy">Copy</a></div></div><div id="ID2EAAADACAAA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="highlight-comment">// Render opaque objects...</span>

<span class="highlight-comment">// Render water.</span>
waterRenderer.Render(waterNodes, context);</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID2EAAADACAAA");</script></div><h4 class="subHeading" id="Refraction">Refractions</h4><div class="subsection"><p>
                            The
                            <a href="a88a6a4e-ce04-777a-96d0-465293ed24f3.htm">WaterRenderer</a>
                            renders refractions and for this it needs a texture which contains an image of the
                            current scene. It expects this texture in
                            <a href="a79b5836-820d-ace2-7ff1-7a8f4f3710a6.htm">RenderContext<span id="LSTC84BB5A9_1"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTC84BB5A9_1?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>SourceTexture</a>.
                            If
                            <a href="a79b5836-820d-ace2-7ff1-7a8f4f3710a6.htm">RenderContext<span id="LSTC84BB5A9_2"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTC84BB5A9_2?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>SourceTexture</a>
                            is <span class="code">null</span>, the
                            <a href="a88a6a4e-ce04-777a-96d0-465293ed24f3.htm">WaterRenderer</a>
                            automatically resolves the current render target (which must be an off-screen render target),
                            replaces it with a new render target, like this:
                        </p><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID2EABACACAAA_tab1" class="codeSnippetContainerTabSingle">C#</div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID2EABACACAAA_copyCode" href="#" onclick="javascript:CopyToClipboard('ID2EABACACAAA');return false;" title="Copy">Copy</a></div></div><div id="ID2EABACACAAA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="highlight-keyword">if</span> (context.SourceTexture == <span class="highlight-keyword">null</span> &amp;&amp; context.RenderTarget != <span class="highlight-keyword">null</span>)
{
  context.SourceTexture = context.RenderTarget;
  context.RenderTarget = renderTargetPool.Obtain2D(<span class="highlight-keyword">new</span> RenderTargetFormat(context.RenderTarget));
  graphicsDevice.SetRenderTarget(context.RenderTarget);
  graphicsDevice.Viewport = context.Viewport;
  _rebuildZBufferRenderer.Render(context, context.SourceTexture);
}</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID2EABACACAAA");</script><p>
                            That means, it is not necessary to set
                            <a href="a79b5836-820d-ace2-7ff1-7a8f4f3710a6.htm">RenderContext<span id="LSTC84BB5A9_3"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTC84BB5A9_3?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>SourceTexture</a>
                            manually before calling the
                            <a href="a88a6a4e-ce04-777a-96d0-465293ed24f3.htm">WaterRenderer</a>.
                            However, it is sometimes more efficient if
                            <a href="a79b5836-820d-ace2-7ff1-7a8f4f3710a6.htm">RenderContext<span id="LSTC84BB5A9_4"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTC84BB5A9_4?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>SourceTexture</a>
                            is set explicitly.
                        </p></div><h4 class="subHeading" id="AlphaBlending">Water and alpha-blended/transparent objects</h4><div class="subsection"><p>
                            Water is similar to an alpha-blended object. The render order is relevant.
                            Especially, if transparent objects intersect the water surface, some rendering artifacts
                            will be visible.
                        </p><p>
                            In many games, alpha-blended objects and the player camera will not enter the water.
                            In this case, water should be rendered before all alpha-blended objects.
                        </p><p>
                            If transparent objects and the player camera can enter the water, following render
                            order is better:
                        </p><ul><li>
                                If camera is above the water surface:
                                <ol><li>
                                        Render alpha-blended objects which are under the water surface.
                                    </li><li>
                                        Render the water.
                                    </li><li>
                                        Render alpha-blended objects which are above the water surface.
                                    </li></ol></li><li>
                                If camera is under the water surface:
                                <ol><li>
                                        Render alpha-blended objects.
                                    </li><li>
                                        Render the water.
                                    </li></ol></li></ul></div><h4 class="subHeading" id="WaterWavesRenderer">WaterWavesRenderer</h4><div class="subsection"><p>
                            The
                            <a href="8e1de4f4-857b-fcad-0180-b30497a56b7c.htm">WaterWavesRenderer</a>
                            is a <a href="c022a3a4-2330-9b46-24ad-c8f3ae13f1f8.htm">SceneNodeRenderer</a>
                            which handles <a href="a37d4fda-9e99-bfc3-8c39-f6d020547d4b.htm">WaterNode</a>s.
                            If a
                            <a href="a37d4fda-9e99-bfc3-8c39-f6d020547d4b.htm">WaterNode</a>
                            references an
                            <a href="d75a9c99-aff1-74b5-443d-2eac30055c81.htm">OceanWaves</a>
                            instance, the renderer performs the ocean simulation, creates the wave displacement texture
                            and the normal texture and stores the result in the
                            <a href="d75a9c99-aff1-74b5-443d-2eac30055c81.htm">OceanWaves</a>
                            instance.
                        </p><p>
                            Currently, the
                            <a href="8e1de4f4-857b-fcad-0180-b30497a56b7c.htm">WaterWavesRenderer</a>
                            supports only
                            <a href="d75a9c99-aff1-74b5-443d-2eac30055c81.htm">OceanWaves</a>.
                            It does not support any other wave type derived from
                            <a href="dbb249d5-f8b7-715b-faea-ddee5c3194a1.htm">WaterWaves</a>.
                        </p><p>
                            Wave textures are usually generated at the start of the <strong>Draw</strong>-method,
                            before the scene is rendered:
                        </p><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID2EABAAACAAA_tab1" class="codeSnippetContainerTabSingle">C#</div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID2EABAAACAAA_copyCode" href="#" onclick="javascript:CopyToClipboard('ID2EABAAACAAA');return false;" title="Copy">Copy</a></div></div><div id="ID2EABAAACAAA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="highlight-comment">// Compute ocean waves.</span>
waterWavesRenderer.Render(waterNodes, context);

<span class="highlight-comment">// Render scene...</span></pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID2EABAAACAAA");</script><p>
                            To summarize: The
                            <a href="8e1de4f4-857b-fcad-0180-b30497a56b7c.htm">WaterWavesRenderer</a>
                            creates the wave displacement and normal textures of
                            <a href="d75a9c99-aff1-74b5-443d-2eac30055c81.htm">OceanWaves</a>.
                        </p></div></div><div class="collapsibleAreaRegion" id="FurtherReading"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID4RB')" onkeypress="SectionExpandCollapse_CheckKey('ID4RB', event)" tabindex="0"><img id="ID4RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Further Reading</span></div><div id="ID4RBSection" class="collapsibleSection"><ul class="noBullet"><li><p><a href="http://www.digitalrune.com/Blog/Post/1758/Water-Rendering" target="_blank">Water Rendering (DigitalRune Blog)</a></p></li><li><p><a href="http://www.digitalrune.com/Blog/Post/1756/Water-Rendering-Resources" target="_blank">Water Rendering - Resources (DigitalRune Blog)</a></p></li></ul></div></div></div><div id="pageFooter" class="pageFooter">Copyright (c) 2006-2016 DigitalRune GmbH. All rights reserved. (Last updated: 2016-03-10)<p><a href="http://www.digitalrune.com/" target="_blank">http://www.digitalrune.com/</a></p><div class="feedbackLink">Send comments on this topic to
        <a id="HT_MailLink" href="mailto:office%40digitalrune.com?Subject=DigitalRune Documentation">office@digitalrune.com</a></div><script type="text/javascript">
        var HT_mailLink = document.getElementById("HT_MailLink");
        var HT_mailLinkText = HT_mailLink.innerHTML;
        HT_mailLink.href += ": " + document.title + "\u0026body=" + encodeURIComponent("Your feedback is used to improve the documentation and the product. Your e-mail address will not be used for any other purpose and is disposed of after the issue you report is resolved. While working to resolve the issue that you report, you may be contacted via e-mail to get further details or clarification on the feedback you sent. After the issue you report has been addressed, you may receive an e-mail to let you know that your feedback has been addressed.");
        HT_mailLink.innerHTML = HT_mailLinkText;
        </script></div></body></html>